{% extends 'Dashboard/base_dashboard.html' %}
{% load static %}

{% block title %}Mis Grupos - Agenda Virtual Eiwa{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/groups.css' %}">
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Mis Grupos</h1>
    <p>Gestiona tus grupos y actividades</p>
</div>

<div class="groups-actions" style="margin-bottom: 30px;">
    <a href="{% url 'create_group' %}" class="btn btn-primary">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        Crear Grupo
    </a>
    <a href="{% url 'join_group' %}" class="btn btn-secondary">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="8.5" cy="7" r="4"></circle>
            <line x1="20" y1="8" x2="20" y2="14"></line>
            <line x1="23" y1="11" x2="17" y2="11"></line>
        </svg>
        Unirse a Grupo
    </a>
</div>



<!-- Solicitudes pendientes del usuario -->
{% if pending_requests %}
<div class="pending-section">
    <h2>Solicitudes Pendientes</h2>
    <div class="groups-grid">
        {% for request in pending_requests %}
        <div class="group-card pending-card">
            <div class="group-card-header">
                <h3>{{ request.group.name }}</h3>
                <span class="role-badge" style="background: #ffc107; color: #000;">Pendiente</span>
            </div>
            <p class="group-card-description">{{ request.group.description|truncatewords:15 }}</p>
            <p style="font-size: 0.85rem; color: #666; margin-top: 10px;">
                Esperando aprobación del líder
            </p>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- Grupos del usuario -->
{% if user_groups %}
<div style="margin-top: 30px;">
    <h2>Mis Grupos</h2>
    <div class="groups-grid">
        {% for membership in user_groups %}
        <a href="{% url 'group_detail' membership.group.id %}" class="group-card">
            <div class="group-card-header">
                <h3>{{ membership.group.name }}</h3>
                <span class="role-badge role-{{ membership.role }}">{{ membership.get_role_display }}</span>
            </div>
            <p class="group-card-description">{{ membership.group.description|truncatewords:15 }}</p>
            <div class="group-card-footer">
                <span class="group-stat">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                    </svg>
                    {{ membership.group.members.count }} miembros
                </span>
            </div>
        </a>
        {% endfor %}
    </div>
</div>
{% elif not pending_requests %}
<div class="empty-state-card">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
    </svg>
    <h3>No tienes grupos aún</h3>
    <p>Crea un grupo o únete a uno existente para comenzar</p>
</div>
{% endif %}
{% endblock %}